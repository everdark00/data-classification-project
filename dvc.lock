schema: '2.0'
stages:
  tika_de:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=de
    deps:
    - path: data/raw//de
      md5: 65071be381cd1cca54898b81324ee189.dir
      size: 75790954761
      nfiles: 333115
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//de
      md5: c1a5a2ace58b0a2679e4f433fc9c8a68.dir
      size: 8348823959
      nfiles: 333115
  tokenizer_de:
    cmd: export PYTHONPATH=$PWD && python -m spacy download de_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=de
    deps:
    - path: data/interim/tika/de
      md5: c1a5a2ace58b0a2679e4f433fc9c8a68.dir
      size: 8348823959
      nfiles: 333115
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/de
      md5: 9de9ddb5794403a84ebda82634c5a62a.dir
      size: 2949891730
      nfiles: 9
  train_de:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=de
    deps:
    - path: data/interim/tokenizer/de
      md5: 9de9ddb5794403a84ebda82634c5a62a.dir
      size: 2949891730
      nfiles: 9
    - path: src/train_model.py
      md5: 241bab755a2529c8bdf585908da2d53d
      size: 7727
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/de/pca.txt
      md5: ce8f51471fcb7465bbb02dc7cbe28410
      size: 8439444
    - path: data/interim/train/de/tfidf_idf.txt
      md5: 563ccaea6c8000b60c435c98a4ccab78
      size: 18930
    - path: data/interim/train/de/tfidf_vocab.txt
      md5: 09a016d045f5b35db6d4f9aed3f518ab
      size: 10989
    - path: data/interim/train/de/tfidf_vocab_words.txt
      md5: 3e48bd4eef9bee06879ff2b64b41e297
      size: 7570
    - path: models//de/model.txt
      md5: cac2bd22ebcb674047c7934b27e5dd1a
      size: 509568
    - path: models//de/pca.pkl
      md5: 08dcc5e92394963192607857ed80a0b4
      size: 3163939
    - path: models//de/tfidf.pkl
      md5: 5a9b897055bfdd50630263c131fe4804
      size: 34873890
    - path: reports//de/confusion.csv
      md5: 7c4d4a3aa1b846dd1a131f4c0667e9be
      size: 127217
    - path: reports//de/metrics.json
      md5: ca30b97585890340c9c6bdae754b28e0
      size: 74
    - path: reports//de/pca_fig.pdf
      md5: 774e4ac65a46f26cd27467ddafb08073
      size: 12122
  make_small_dataset:
    cmd: export PYTHONPATH=$PWD && python src/make_test_dataset.py --config=params.yaml
      --test_dir=data_test
    deps:
    - path: src/make_test_dataset.py
      md5: 4e20ef1eccd297616b6489620534bb13
      size: 1567
    outs:
    - path: data_test/raw
      md5: 0ec988ffeafd1141053b59906970c090.dir
      size: 1288817088
      nfiles: 4065
  tika_fr:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=fr
    deps:
    - path: data/raw//fr
      md5: 90cdb249083262b434ee57d2949e7c10.dir
      size: 88951903981
      nfiles: 341340
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//fr
      md5: 3dbc49c4c011239cb056f378b7643f8e.dir
      size: 8698283524
      nfiles: 341340
  tokenizer_fr:
    cmd: export PYTHONPATH=$PWD && python -m spacy download fr_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=fr
    deps:
    - path: data/interim/tika/fr
      md5: 3dbc49c4c011239cb056f378b7643f8e.dir
      size: 8698283524
      nfiles: 341340
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/fr
      md5: 7fef1055e328fe85c47ee7fdaa696c96.dir
      size: 2800908347
      nfiles: 9
  train_fr:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=fr
    deps:
    - path: data/interim/tokenizer/fr
      md5: 7fef1055e328fe85c47ee7fdaa696c96.dir
      size: 2800908347
      nfiles: 9
    - path: src/train_model.py
      md5: 241bab755a2529c8bdf585908da2d53d
      size: 7727
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/fr/pca.txt
      md5: 7f310f6fb2bb00aef7be42ed7a9f2184
      size: 8427859
    - path: data/interim/train/fr/tfidf_idf.txt
      md5: da3b505c63299886dc206e0f048b5b01
      size: 18940
    - path: data/interim/train/fr/tfidf_vocab.txt
      md5: 92e6548fc9044406329dde3b916164e9
      size: 11005
    - path: data/interim/train/fr/tfidf_vocab_words.txt
      md5: 32cba6754e5ae0baae23f5adcb0bb1b6
      size: 7507
    - path: models//fr/model.txt
      md5: d95226025f5234a04c994101b44981a3
      size: 509667
    - path: models//fr/pca.pkl
      md5: d82a4cddd6b91ff8c2923cfe6109c8d2
      size: 3163939
    - path: models//fr/tfidf.pkl
      md5: 769cc3a471b53b6dcc291654c6235258
      size: 15328806
    - path: reports//fr/confusion.csv
      md5: 39b89963553d2237b4372666ffc0f5dc
      size: 125013
    - path: reports//fr/metrics.json
      md5: 92b6434e41f74aed1bb8b19046c26263
      size: 75
    - path: reports//fr/pca_fig.pdf
      md5: 980c34be55eb6f9e539831c77a692fdc
      size: 12128
  tika_it:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=it
    deps:
    - path: data/raw//it
      md5: f91b43c20c58e309afb4561e67299303.dir
      size: 47722809107
      nfiles: 191210
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//it
      md5: 5a073eb3e79b8f9847ffab36b8198d29.dir
      size: 4847095940
      nfiles: 191210
  tokenizer_it:
    cmd: export PYTHONPATH=$PWD && python -m spacy download it_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=it
    deps:
    - path: data/interim/tika/it
      md5: 5a073eb3e79b8f9847ffab36b8198d29.dir
      size: 4847095940
      nfiles: 191210
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/it
      md5: 2059010462efaa10cc3672ec7a7f4f00.dir
      size: 2157309356
      nfiles: 9
  train_it:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=it
    deps:
    - path: data/interim/tokenizer/it
      md5: 2059010462efaa10cc3672ec7a7f4f00.dir
      size: 2157309356
      nfiles: 9
    - path: src/train_model.py
      md5: 241bab755a2529c8bdf585908da2d53d
      size: 7727
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/it/pca.txt
      md5: 1bc1cf909eabf37668b6a60a7c7d2e6c
      size: 8424886
    - path: data/interim/train/it/tfidf_idf.txt
      md5: cf2c9bb8b21a11d38fb3aba1e65125f0
      size: 18965
    - path: data/interim/train/it/tfidf_vocab.txt
      md5: 457c802193f9fc8c795ecbbeb83ffb38
      size: 11006
    - path: data/interim/train/it/tfidf_vocab_words.txt
      md5: 5be982f971592b6d1158989bad13c79b
      size: 7907
    - path: models//it/model.txt
      md5: 963f0b71e5106d4b2b155f3dd6b40fbb
      size: 508760
    - path: models//it/pca.pkl
      md5: e8e375b2c36daf1c446b8487c44f5668
      size: 3163937
    - path: models//it/tfidf.pkl
      md5: 9e4c6073879f54346f4f3a8856283077
      size: 14162530
    - path: reports//it/confusion.csv
      md5: 5a952d1250794e9446d2e831448eaa7d
      size: 68081
    - path: reports//it/metrics.json
      md5: 688d3e4c788766cdd11e228278bf4e26
      size: 75
    - path: reports//it/pca_fig.pdf
      md5: 209e9634151b62f4544f349eca5963ec
      size: 12105
  tika_es:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=es
    deps:
    - path: data/raw//es
      md5: a0d6495d920216ede703c75b1817baf8.dir
      size: 46119187756
      nfiles: 334412
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//es
      md5: e609fe493830c55d29f52a2d235505dc.dir
      size: 7807202360
      nfiles: 334412
  tokenizer_es:
    cmd: export PYTHONPATH=$PWD && python -m spacy download es_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=es
    deps:
    - path: data/interim/tika/es
      md5: e609fe493830c55d29f52a2d235505dc.dir
      size: 7807202360
      nfiles: 334412
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/es
      md5: bf46b1ba80e7a6d357039f779352477e.dir
      size: 2533331724
      nfiles: 9
  train_es:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=es
    deps:
    - path: data/interim/tokenizer/es
      md5: bf46b1ba80e7a6d357039f779352477e.dir
      size: 2533331724
      nfiles: 9
    - path: src/train_model.py
      md5: 241bab755a2529c8bdf585908da2d53d
      size: 7727
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/es/pca.txt
      md5: ee5927506232ad86a71e063d993cd8e1
      size: 8428705
    - path: data/interim/train/es/tfidf_idf.txt
      md5: 6cca43343585cd29ffbe2c6fd79fd4fd
      size: 18922
    - path: data/interim/train/es/tfidf_vocab.txt
      md5: 4b4c877806394591162f69f6ef4ea0ce
      size: 10997
    - path: data/interim/train/es/tfidf_vocab_words.txt
      md5: 37d5a788b4a442f9a50fc7dba06e1b1a
      size: 7732
    - path: models//es/model.txt
      md5: 867db970b9f2cfb4312f1ca7f76e4d83
      size: 509431
    - path: models//es/pca.pkl
      md5: 236340b3f5858bd7f0330c5b29cb18a0
      size: 3163939
    - path: models//es/tfidf.pkl
      md5: c8633670deb9628ffdaa22ae980432e4
      size: 23488813
    - path: reports//es/confusion.csv
      md5: daab86752809d14670e1d21d07325217
      size: 131125
    - path: reports//es/metrics.json
      md5: 0911b280ca342148b83b44bef5ece1f5
      size: 75
    - path: reports//es/pca_fig.pdf
      md5: 697103efc0810ff0976c53e15cd2d5fa
      size: 12153
