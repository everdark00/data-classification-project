schema: '2.0'
stages:
  tika_de:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=de
    deps:
    - path: data/raw//de
      md5: 65071be381cd1cca54898b81324ee189.dir
      size: 75790954761
      nfiles: 333115
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//de
      md5: e034c630ae9a24b8fc2d991e6839805a.dir
      size: 8348833410
      nfiles: 333115
  tokenizer_de:
    cmd: export PYTHONPATH=$PWD && python -m spacy download de_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=de
    deps:
    - path: data/interim/tika/de
      md5: e034c630ae9a24b8fc2d991e6839805a.dir
      size: 8348833410
      nfiles: 333115
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/de
      md5: dc5054851f2900f37b45b18d4e6d8972.dir
      size: 2949891730
      nfiles: 9
  train_de:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=de
    deps:
    - path: data/interim/tokenizer/de
      md5: dc5054851f2900f37b45b18d4e6d8972.dir
      size: 2949891730
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/de/pca.txt
      md5: bc3cd1db468003428681560d669349db
      size: 8440389
    - path: data/interim/train/de/tfidf_idf.txt
      md5: f5bccc4970378ea352ffa855caa0c54f
      size: 18893
    - path: data/interim/train/de/tfidf_vocab.txt
      md5: b636d792e727882bf1b6f45f612055ca
      size: 10989
    - path: data/interim/train/de/tfidf_vocab_words.txt
      md5: ba873eee7a5686c80e4b5d9427c5fdfd
      size: 7579
    - path: models//de/model.txt
      md5: 3b48a7e264c39a4a3fc730f58d59138e
      size: 509817
    - path: models//de/pca.pkl
      md5: 9caaca4094ccb0a5d0b244f839846c2c
      size: 3163939
    - path: models//de/tfidf.pkl
      md5: 1769a83082487eaf88872a21ba9ea4e8
      size: 34123161
    - path: reports//de/confusion.csv
      md5: 2ec9e4c6e43159b847d37f30ff241ca1
      size: 127217
    - path: reports//de/confusion.pdf
      md5: 49088be41b920700e549c96238a32741
      size: 20529
    - path: reports//de/metrics.json
      md5: ff8a3bbc51586c9e1f20978a1ec27871
      size: 75
    - path: reports//de/pca_fig.pdf
      md5: 88f1d22405c19276cf92d3a76916e66d
      size: 12131
  make_small_dataset:
    cmd: export PYTHONPATH=$PWD && python src/make_test_dataset.py --config=params.yaml
      --test_dir=data_test
    deps:
    - path: src/make_test_dataset.py
      md5: 4e20ef1eccd297616b6489620534bb13
      size: 1567
    outs:
    - path: data_test/raw
      md5: 0cae65c5eb883acfaa9d4d34fa011bdb.dir
      size: 2100058684
      nfiles: 8090
  tika_fr:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=fr
    deps:
    - path: data/raw//fr
      md5: 90cdb249083262b434ee57d2949e7c10.dir
      size: 88951903981
      nfiles: 341340
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//fr
      md5: a05c273381b20b79ceb8f9434661cba3.dir
      size: 8698289983
      nfiles: 341340
  tokenizer_fr:
    cmd: export PYTHONPATH=$PWD && python -m spacy download fr_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=fr
    deps:
    - path: data_test/interim/tika/fr
      md5: fbee0c574b69a0a9481865034a1ded35.dir
      size: 51323778
      nfiles: 2040
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/fr
      md5: c9a4018e28bcf9ea52f60010b1879ed8.dir
      size: 18536540
      nfiles: 9
  train_fr:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/interim/tokenizer/fr
      md5: c9a4018e28bcf9ea52f60010b1879ed8.dir
      size: 18536540
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/fr/pca.txt
      md5: 68ef9ac0a9020629cf137004b6e00b95
      size: 8384999
    - path: data_test/interim/train/fr/tfidf_idf.txt
      md5: 55c2d0bc9be25cbfb418e9235b82d30e
      size: 18889
    - path: data_test/interim/train/fr/tfidf_vocab.txt
      md5: 18e25d03d865c2acacd838340ac8b93c
      size: 10998
    - path: data_test/interim/train/fr/tfidf_vocab_words.txt
      md5: e7ed4eba4cd14e79b06af4714d1a6e99
      size: 7733
    - path: models//fr/model.txt
      md5: ffbb57660c42ef82bbef017486daac27
      size: 240118
    - path: models//fr/pca.pkl
      md5: da792008f3103caeb5ee7396c9bb2aa6
      size: 3163937
    - path: models//fr/tfidf.pkl
      md5: 2b3fc3ab5e2e8034054c14125abb763c
      size: 579541
    - path: reports//fr/confusion.csv
      md5: 0fb9c4888d3b72012ac0e5787ea6bfd4
      size: 697
    - path: reports//fr/confusion.pdf
      md5: c47a774e1447c6c7abc5ce8f292628a5
      size: 19676
    - path: reports//fr/metrics.json
      md5: 0913ab61f9f5a4dcdee9fb105d966590
      size: 60
    - path: reports//fr/pca_fig.pdf
      md5: 4aa81cfa2d4e3a697bf96860119a15ce
      size: 13017
  tika_es:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/raw//es
      md5: 06995e5f599d780476f5c48b4962561d.dir
      size: 381960590
      nfiles: 2160
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//es
      md5: d6c866314ebf70845db14212e03e8b62.dir
      size: 47063412
      nfiles: 2160
  tokenizer_es:
    cmd: export PYTHONPATH=$PWD && python -m spacy download es_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=es
    deps:
    - path: data_test/interim/tika/es
      md5: d6c866314ebf70845db14212e03e8b62.dir
      size: 47063412
      nfiles: 2160
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/es
      md5: 31a644dba8de24a978276b638ce8d1d1.dir
      size: 16124191
      nfiles: 9
  train_es:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/interim/tokenizer/es
      md5: 31a644dba8de24a978276b638ce8d1d1.dir
      size: 16124191
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/es/pca.txt
      md5: 8dd599540e8f782ceafea4aba045e296
      size: 8385150
    - path: data_test/interim/train/es/tfidf_idf.txt
      md5: 705eed0c39b0ea34c96306ab05143ab6
      size: 18897
    - path: data_test/interim/train/es/tfidf_vocab.txt
      md5: ceaa24213bc133a1fac8ad454f5bf8b3
      size: 10993
    - path: data_test/interim/train/es/tfidf_vocab_words.txt
      md5: 36264c99be7ef4bdb6c5b6764ee98619
      size: 7870
    - path: models//es/model.txt
      md5: 490af0f001407a10fa083cdc0d059c60
      size: 275099
    - path: models//es/pca.pkl
      md5: 6a5b09a0f3927c67dfbcc12930ac8ec3
      size: 3163931
    - path: models//es/tfidf.pkl
      md5: 519f5d2b6d7fecb40f930fb0d25a1e1b
      size: 805144
    - path: reports//es/confusion.csv
      md5: 987410edfad9c8744c76c01a7eeb7b2c
      size: 633
    - path: reports//es/confusion.pdf
      md5: c472ab5c7ee0455bad691005b85e588b
      size: 19748
    - path: reports//es/metrics.json
      md5: 294139c22371065939fcf46e370537ae
      size: 60
    - path: reports//es/pca_fig.pdf
      md5: 222c9c634fc2013253a721246ca604b1
      size: 12609
  tika_it:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=it
    deps:
    - path: data/raw//it
      md5: f91b43c20c58e309afb4561e67299303.dir
      size: 47722809107
      nfiles: 191210
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//it
      md5: 1fff2f318f4d59dcc1b2c93ec8545afa.dir
      size: 4847098889
      nfiles: 191210
  tokenizer_it:
    cmd: export PYTHONPATH=$PWD && python -m spacy download it_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=it
    deps:
    - path: data/interim/tika/it
      md5: 1fff2f318f4d59dcc1b2c93ec8545afa.dir
      size: 4847098889
      nfiles: 191210
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/it
      md5: 6f484dbbead6bfd5e4dd9ddafe651ef3.dir
      size: 2157309356
      nfiles: 9
  train_it:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/interim/tokenizer/it
      md5: b21fe8d734a17a44c5fa334d4c8ce171.dir
      size: 19759118
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/it/pca.txt
      md5: ace3b0b5d72330a8b49905be3c07786c
      size: 8384591
    - path: data_test/interim/train/it/tfidf_idf.txt
      md5: a9cd6523230b45a5b1e29a3b938c8b0c
      size: 18947
    - path: data_test/interim/train/it/tfidf_vocab.txt
      md5: efb51605884ff0f34f3dabb6aa0e8d00
      size: 11016
    - path: data_test/interim/train/it/tfidf_vocab_words.txt
      md5: 272786c124ffff004d609d04cd127113
      size: 7762
    - path: models//it/model.txt
      md5: 062f01866685355c7c9c0d3b71f50ec2
      size: 200702
    - path: models//it/pca.pkl
      md5: 1f3232477822e570084dede8ed3d6875
      size: 3163937
    - path: models//it/tfidf.pkl
      md5: bca7f24eb3346ace1df422adc879ca5c
      size: 744680
    - path: reports//it/confusion.csv
      md5: 56921bc72774fe5c57990bf2c66dbd8a
      size: 661
    - path: reports//it/confusion.pdf
      md5: e9f555901fa1e7e492dd64cc9ba71d97
      size: 19748
    - path: reports//it/metrics.json
      md5: 0abbc2be4e5269228b2b3129996125fd
      size: 60
    - path: reports//it/pca_fig.pdf
      md5: 48f665fc2aacb37a396f711f564a678a
      size: 13023
