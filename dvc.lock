schema: '2.0'
stages:
  tika_de:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=de
    deps:
    - path: data/raw//de
      md5: 65071be381cd1cca54898b81324ee189.dir
      size: 75790954761
      nfiles: 333115
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//de
      md5: c1a5a2ace58b0a2679e4f433fc9c8a68.dir
      size: 8348823959
      nfiles: 333115
  tokenizer_de:
    cmd: export PYTHONPATH=$PWD && python -m spacy download de_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=de
    deps:
    - path: data/interim/tika/de
      md5: c1a5a2ace58b0a2679e4f433fc9c8a68.dir
      size: 8348823959
      nfiles: 333115
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/de
      md5: 9de9ddb5794403a84ebda82634c5a62a.dir
      size: 2949891730
      nfiles: 9
  train_de:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=de
    deps:
    - path: data//interim/tokenizer/de
      md5: 88f2db8e90ddbc9bff7acd4f16c9995b.dir
      size: 2949891730
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data/
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data//interim/train/de/pca.txt
      md5: 21281fee785f53507449fb8cace03812
      size: 8440471
    - path: data//interim/train/de/tfidf_idf.txt
      md5: f4e7c4770c435104c493808b241890e6
      size: 18928
    - path: data//interim/train/de/tfidf_vocab.txt
      md5: 38abc3b1cfb6086896e9efd147e8bc22
      size: 10990
    - path: data//interim/train/de/tfidf_vocab_words.txt
      md5: 240feb5df96c0a68379fa9229659fd6d
      size: 7569
    - path: models//de/model.txt
      md5: 86c9741d861b8037c58074a2c469e737
      size: 509748
    - path: models//de/pca.pkl
      md5: 5dd4c5670fbedcff5e5059d625019c93
      size: 3163939
    - path: models//de/tfidf.pkl
      md5: da18e3ecfd8a4b557646c4986fa6e524
      size: 34175368
    - path: reports//de/confusion.csv
      md5: b46e8a86b2ecb422f29b368a64ea9d65
      size: 127217
    - path: reports//de/confusion.pdf
      md5: 99aee62fdab19705e3f0e6862e2838ec
      size: 20510
    - path: reports//de/metrics.json
      md5: 1c0f67897a3cfb73ae10ce70c307cff6
      size: 75
    - path: reports//de/pca_fig.pdf
      md5: 48f01c105a5e42913caa91d8743fc60d
      size: 12115
  make_small_dataset:
    cmd: export PYTHONPATH=$PWD && python src/make_test_dataset.py --config=params.yaml
      --test_dir=data_test
    deps:
    - path: src/make_test_dataset.py
      md5: 4e20ef1eccd297616b6489620534bb13
      size: 1567
    outs:
    - path: data_test/raw
      md5: 0ec988ffeafd1141053b59906970c090.dir
      size: 1288817088
      nfiles: 4065
  tika_fr:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=fr
    deps:
    - path: data/raw//fr
      md5: 90cdb249083262b434ee57d2949e7c10.dir
      size: 88951903981
      nfiles: 341340
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//fr
      md5: 3dbc49c4c011239cb056f378b7643f8e.dir
      size: 8698283524
      nfiles: 341340
  tokenizer_fr:
    cmd: export PYTHONPATH=$PWD && python -m spacy download fr_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=fr
    deps:
    - path: data/interim/tika/fr
      md5: 3dbc49c4c011239cb056f378b7643f8e.dir
      size: 8698283524
      nfiles: 341340
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/fr
      md5: 7fef1055e328fe85c47ee7fdaa696c96.dir
      size: 2800908347
      nfiles: 9
  train_fr:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=fr
    deps:
    - path: data/interim/tokenizer/fr
      md5: fc3e4b5178e0a82462eb5c7fc228df86.dir
      size: 2800891515
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/fr/pca.txt
      md5: 7af4cbadadb543ad2d4da2968804df81
      size: 8427580
    - path: data/interim/train/fr/tfidf_idf.txt
      md5: 5f23bab4a939b87374f110dcc9d1b1e6
      size: 18971
    - path: data/interim/train/fr/tfidf_vocab.txt
      md5: 6e77970fe1200eacf7ec62181b8c8e3a
      size: 11005
    - path: data/interim/train/fr/tfidf_vocab_words.txt
      md5: d7fc837826debfb9c1c91e3ec1d03dc5
      size: 7497
    - path: models//fr/model.txt
      md5: cbef0b0c58a1cd3b35bf784c70e53273
      size: 509761
    - path: models//fr/pca.pkl
      md5: 6b2cda3cb69f1ac88f50a6706dce20a5
      size: 3163939
    - path: models//fr/tfidf.pkl
      md5: 6e6288d69bd58763b2947b9262426ec7
      size: 15368024
    - path: reports//fr/confusion.csv
      md5: 05686380d105d81d923e9175bee8c87f
      size: 125013
    - path: reports//fr/confusion.pdf
      md5: dea0aabe277c420dd417dc26e804d5f3
      size: 20422
    - path: reports//fr/metrics.json
      md5: 87560c30952db3abbfac6b3332a793ff
      size: 75
    - path: reports//fr/pca_fig.pdf
      md5: e200fa81e903728c72fc64ff4ac6684f
      size: 12148
  tika_it:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=it
    deps:
    - path: data/raw//it
      md5: f91b43c20c58e309afb4561e67299303.dir
      size: 47722809107
      nfiles: 191210
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//it
      md5: 5a073eb3e79b8f9847ffab36b8198d29.dir
      size: 4847095940
      nfiles: 191210
  tokenizer_it:
    cmd: export PYTHONPATH=$PWD && python -m spacy download it_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=it
    deps:
    - path: data/interim/tika/it
      md5: 5a073eb3e79b8f9847ffab36b8198d29.dir
      size: 4847095940
      nfiles: 191210
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/it
      md5: 2059010462efaa10cc3672ec7a7f4f00.dir
      size: 2157309356
      nfiles: 9
  train_it:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=it
    deps:
    - path: data/interim/tokenizer/it
      md5: 2059010462efaa10cc3672ec7a7f4f00.dir
      size: 2157309356
      nfiles: 9
    - path: src/train_model.py
      md5: 241bab755a2529c8bdf585908da2d53d
      size: 7727
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data/interim/train/it/pca.txt
      md5: 1bc1cf909eabf37668b6a60a7c7d2e6c
      size: 8424886
    - path: data/interim/train/it/tfidf_idf.txt
      md5: cf2c9bb8b21a11d38fb3aba1e65125f0
      size: 18965
    - path: data/interim/train/it/tfidf_vocab.txt
      md5: 457c802193f9fc8c795ecbbeb83ffb38
      size: 11006
    - path: data/interim/train/it/tfidf_vocab_words.txt
      md5: 5be982f971592b6d1158989bad13c79b
      size: 7907
    - path: models//it/model.txt
      md5: 963f0b71e5106d4b2b155f3dd6b40fbb
      size: 508760
    - path: models//it/pca.pkl
      md5: e8e375b2c36daf1c446b8487c44f5668
      size: 3163937
    - path: models//it/tfidf.pkl
      md5: 9e4c6073879f54346f4f3a8856283077
      size: 14162530
    - path: reports//it/confusion.csv
      md5: 5a952d1250794e9446d2e831448eaa7d
      size: 68081
    - path: reports//it/metrics.json
      md5: 688d3e4c788766cdd11e228278bf4e26
      size: 75
    - path: reports//it/pca_fig.pdf
      md5: 209e9634151b62f4544f349eca5963ec
      size: 12105
  tika_es:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=es
    deps:
    - path: data/raw//es
      md5: a0d6495d920216ede703c75b1817baf8.dir
      size: 46119187756
      nfiles: 334412
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data/interim/tika//es
      md5: e609fe493830c55d29f52a2d235505dc.dir
      size: 7807202360
      nfiles: 334412
  tokenizer_es:
    cmd: export PYTHONPATH=$PWD && python -m spacy download es_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=es
    deps:
    - path: data/interim/tika/es
      md5: e609fe493830c55d29f52a2d235505dc.dir
      size: 7807202360
      nfiles: 334412
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data/interim/tokenizer/es
      md5: bf46b1ba80e7a6d357039f779352477e.dir
      size: 2533331724
      nfiles: 9
