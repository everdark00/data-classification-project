schema: '2.0'
stages:
  tika_de:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=de
    deps:
    - path: data_test/raw//de
      md5: 358fa374b312736881e8be829500010d.dir
      size: 100607039
      nfiles: 205
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//de
      md5: 9857051be79a3ce405cd9da65e99dd9e.dir
      size: 6711969
      nfiles: 205
  tokenizer_de:
    cmd: export PYTHONPATH=$PWD && python -m spacy download de_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=de
    deps:
    - path: data_test/interim/tika/de
      md5: 9857051be79a3ce405cd9da65e99dd9e.dir
      size: 6711969
      nfiles: 205
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/de
      md5: f3b62d17b930d6a7b102bc1ec7c3f705.dir
      size: 3161416
      nfiles: 9
  train_de:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=de
    deps:
    - path: data_test/interim/tokenizer/de
      md5: f3b62d17b930d6a7b102bc1ec7c3f705.dir
      size: 3161416
      nfiles: 9
    - path: src/train_model.py
      md5: 9f31c4e24fc9a0285e8d8e0f0eb0bf88
      size: 9738
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          validate_size: 0.2
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_explained_variance_threshold: 0.9
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/de/pca.txt
      md5: d400472d2cc6ba8445ced6f2e1515a5f
      size: 729335
    - path: data_test/interim/train/de/tfidf_idf.txt
      md5: bdaac11ffba97d29bf6d677309b066d8
      size: 19090
    - path: data_test/interim/train/de/tfidf_vocab.txt
      md5: ab806f5b154e94d179a69d629bef7ea8
      size: 10985
    - path: data_test/interim/train/de/tfidf_vocab_words.txt
      md5: b5cbe729fdd46f75bc3cce3fb26b841d
      size: 8089
    - path: models//de/model.txt
      md5: ac99ed59fa2e41a6af37b3eb0e1163c1
      size: 5922
    - path: models//de/pca.pkl
      md5: 5ca4f23356e448217d9f892fbaed64dc
      size: 271949
    - path: reports//de/confusion.csv
      md5: 6d1f03274abefdd2d6196839656d926e
      size: 101
    - path: reports//de/metrics.json
      md5: f4d16a1400c539b24783adfbda8df53f
      size: 75
    - path: reports//de/train_progress.json
      md5: c9f04fa8063ceb1fb48476510e96b688
      size: 2419
  make_small_dataset:
    cmd: export PYTHONPATH=$PWD && python src/make_test_dataset.py --config=params.yaml
      --test_dir=data_test
    deps:
    - path: src/make_test_dataset.py
      md5: 369f9c4f31aa5e866b26ac0bd2784a77
      size: 1566
    outs:
    - path: data_test/raw
      md5: 61028a947c595be60db3f480f10cebcc.dir
      size: 298047834
      nfiles: 848
  tika_fr:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/raw//fr
      md5: 99309230414a0c5f9d604a18a19dba4a.dir
      size: 67934726
      nfiles: 218
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//fr
      md5: 4dee194f5756ac245333640152881c35.dir
      size: 4884861
      nfiles: 218
  tokenizer_fr:
    cmd: export PYTHONPATH=$PWD && python -m spacy download fr_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=fr
    deps:
    - path: data_test/interim/tika/fr
      md5: 4dee194f5756ac245333640152881c35.dir
      size: 4884861
      nfiles: 218
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/fr
      md5: 2eb4fd6f51ccd48253c637d620b322b4.dir
      size: 2266604
      nfiles: 9
  train_fr:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/interim/tokenizer/fr
      md5: 2eb4fd6f51ccd48253c637d620b322b4.dir
      size: 2266604
      nfiles: 9
    - path: src/train_model.py
      md5: 9f31c4e24fc9a0285e8d8e0f0eb0bf88
      size: 9738
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          validate_size: 0.2
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_explained_variance_threshold: 0.9
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/fr/pca.txt
      md5: b84268a5551d0ad170da8cf62088c112
      size: 707363
    - path: data_test/interim/train/fr/tfidf_idf.txt
      md5: ddcaeed817db05222b868552a39e30b8
      size: 18767
    - path: data_test/interim/train/fr/tfidf_vocab.txt
      md5: a0441bb5b685d31c790ac33a6b193add
      size: 11001
    - path: data_test/interim/train/fr/tfidf_vocab_words.txt
      md5: 68aa00b019358c65212eeb13624439ce
      size: 7971
    - path: models//fr/model.txt
      md5: 40492927287e4073089b9a51dc8b8a17
      size: 5865
    - path: models//fr/pca.pkl
      md5: f472f04ce9ac897ae9fb120ae96d784b
      size: 263733
    - path: reports//fr/confusion.csv
      md5: d2ba15bc6e99dfd1e05e83131b51d180
      size: 93
    - path: reports//fr/metrics.json
      md5: d3c059d8624b2c2a4201bb0d1c06891f
      size: 77
    - path: reports//fr/train_progress.json
      md5: 719110c0fa4e92b924a846b269de400b
      size: 2419
  tika_es:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/raw//es
      md5: 2f9b8d415aa60da4a90c87966ea366d7.dir
      size: 54698445
      nfiles: 229
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//es
      md5: 135edeb53ea5827cfc40c02767e574f5.dir
      size: 10909073
      nfiles: 229
  tokenizer_es:
    cmd: export PYTHONPATH=$PWD && python -m spacy download es_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=es
    deps:
    - path: data_test/interim/tika/es
      md5: 135edeb53ea5827cfc40c02767e574f5.dir
      size: 10909073
      nfiles: 229
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/es
      md5: ef7e192185c54b29949e86aef63a44d1.dir
      size: 1957425
      nfiles: 9
  train_es:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/interim/tokenizer/es
      md5: ef7e192185c54b29949e86aef63a44d1.dir
      size: 1957425
      nfiles: 9
    - path: src/train_model.py
      md5: 9f31c4e24fc9a0285e8d8e0f0eb0bf88
      size: 9738
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          validate_size: 0.2
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_explained_variance_threshold: 0.9
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/es/pca.txt
      md5: 1f1faecb5bc35b99ce346bf7a115d672
      size: 704478
    - path: data_test/interim/train/es/tfidf_idf.txt
      md5: 6b4aae6fce8a61015a2c8a953050dd89
      size: 18691
    - path: data_test/interim/train/es/tfidf_vocab.txt
      md5: 6b97e01255fb75e4dbe6cd1d85dbdeab
      size: 11002
    - path: data_test/interim/train/es/tfidf_vocab_words.txt
      md5: 7cd3f7ffe278697d1ac9d44392cdafc6
      size: 7813
    - path: models//es/model.txt
      md5: 99930549511624dbada9bf88c52802ef
      size: 5866
    - path: models//es/pca.pkl
      md5: 41b1249afeb93cd2be75302cbc6b98af
      size: 263733
    - path: reports//es/confusion.csv
      md5: 5200d7456872f036909887391331ca9d
      size: 93
    - path: reports//es/metrics.json
      md5: 0c22a4d3df08bf47073b90c43ab5b1e5
      size: 77
    - path: reports//es/train_progress.json
      md5: 918517c5bcc4db1648efb626fd4afc8f
      size: 2419
  tika_it:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/raw//it
      md5: 25f177f79d071d0d9a7528103767b838.dir
      size: 74807624
      nfiles: 196
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//it
      md5: 37dc2249c03d5d3ab1f78473b638674f.dir
      size: 4309483
      nfiles: 196
  tokenizer_it:
    cmd: export PYTHONPATH=$PWD && python -m spacy download it_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=it
    deps:
    - path: data_test/interim/tika/it
      md5: 37dc2249c03d5d3ab1f78473b638674f.dir
      size: 4309483
      nfiles: 196
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/it
      md5: 8ba4c85e6ef1856b9137e332d4a18af5.dir
      size: 2420368
      nfiles: 9
  train_it:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/interim/tokenizer/it
      md5: 8ba4c85e6ef1856b9137e332d4a18af5.dir
      size: 2420368
      nfiles: 9
    - path: src/train_model.py
      md5: 9f31c4e24fc9a0285e8d8e0f0eb0bf88
      size: 9738
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          validate_size: 0.2
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_explained_variance_threshold: 0.9
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/it/pca.txt
      md5: 88417dbaa9f1ece18506fd94b5522b49
      size: 642771
    - path: data_test/interim/train/it/tfidf_idf.txt
      md5: 9ee82c54356ae4a8d58e1a40aa9bb99d
      size: 18820
    - path: data_test/interim/train/it/tfidf_vocab.txt
      md5: 52cb4dcee36cc989d49b494e51f1017b
      size: 11018
    - path: data_test/interim/train/it/tfidf_vocab_words.txt
      md5: 7803f41e48955cbce8ca3d7a186a2591
      size: 8374
    - path: models//it/model.txt
      md5: d63f645f5ccbb831b83a010d6735de6e
      size: 5707
    - path: models//it/pca.pkl
      md5: 8166e196a663074fea220a5afc6c21fa
      size: 239085
    - path: reports//it/confusion.csv
      md5: 610830296f532559bae58fe3ed07100c
      size: 89
    - path: reports//it/metrics.json
      md5: 9a32b77552435173720d91be96ad1b05
      size: 77
    - path: reports//it/train_progress.json
      md5: 4d377a883d3a5a6891837da9cec8ddd4
      size: 2419
