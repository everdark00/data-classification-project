schema: '2.0'
stages:
  tika_de:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=de
    deps:
    - path: data_test/raw//de
      md5: ecf329a5552da9e78fd437c8fff7dc8b.dir
      size: 722998799
      nfiles: 2025
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//de
      md5: 305d2a88839120fcee9434d2c75cc931.dir
      size: 64245795
      nfiles: 2025
  tokenizer_de:
    cmd: export PYTHONPATH=$PWD && python -m spacy download de_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=de
    deps:
    - path: data_test/interim/tika/de
      md5: 305d2a88839120fcee9434d2c75cc931.dir
      size: 64245795
      nfiles: 2025
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/de
      md5: f0301f95edaee556a78366ca394601a9.dir
      size: 24613525
      nfiles: 9
  train_de:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=de
    deps:
    - path: data_test/interim/tokenizer/de
      md5: f0301f95edaee556a78366ca394601a9.dir
      size: 24613525
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/de/pca.txt
      md5: 48dcfdfd56730d2e4430c228d1de3c0b
      size: 8396129
    - path: data_test/interim/train/de/tfidf_idf.txt
      md5: f4586545f1af566139cd64d8fee17e90
      size: 18862
    - path: data_test/interim/train/de/tfidf_vocab.txt
      md5: c2db368afad150e587b6dc0fd77d6d64
      size: 10989
    - path: data_test/interim/train/de/tfidf_vocab_words.txt
      md5: 9c5bffccb2be1f7b27a921e17d2be7a6
      size: 7745
    - path: models//de/model.txt
      md5: 1b2487711d88770cbe3b8beb198840c0
      size: 230094
    - path: models//de/pca.pkl
      md5: 9a37bfbbeb66a54c048409edb8ee1f3b
      size: 3163937
    - path: models//de/tfidf.pkl
      md5: c37fb03983c00f344907839fc0e4d8a8
      size: 1646463
    - path: reports//de/confusion.csv
      md5: f915c90d9a1612bb5507353be3c45f97
      size: 749
    - path: reports//de/confusion.pdf
      md5: 802cf912ce0dfecd1fcd36fc5a0c3f6e
      size: 19531
    - path: reports//de/metrics.json
      md5: 804243f3f2d077cd85d700457313f939
      size: 60
    - path: reports//de/pca_fig.pdf
      md5: efd8f593f69c0c87609693b9f1b8ddac
      size: 13000
  make_small_dataset:
    cmd: export PYTHONPATH=$PWD && python src/make_test_dataset.py --config=params.yaml
      --test_dir=data_test
    deps:
    - path: src/make_test_dataset.py
      md5: 4e20ef1eccd297616b6489620534bb13
      size: 1567
    outs:
    - path: data_test/raw
      md5: 3039a4ee30991c39ab185ce32f00b512.dir
      size: 2100271676
      nfiles: 8092
  tika_fr:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/raw//fr
      md5: ab46d2dd7161ecd9aa77d2ba5830fb06.dir
      size: 550263554
      nfiles: 2040
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//fr
      md5: fbee0c574b69a0a9481865034a1ded35.dir
      size: 51323778
      nfiles: 2040
  tokenizer_fr:
    cmd: export PYTHONPATH=$PWD && python -m spacy download fr_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=fr
    deps:
    - path: data_test/interim/tika/fr
      md5: fbee0c574b69a0a9481865034a1ded35.dir
      size: 51323778
      nfiles: 2040
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/fr
      md5: c9a4018e28bcf9ea52f60010b1879ed8.dir
      size: 18536540
      nfiles: 9
  train_fr:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/interim/tokenizer/fr
      md5: c9a4018e28bcf9ea52f60010b1879ed8.dir
      size: 18536540
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/fr/pca.txt
      md5: 68ef9ac0a9020629cf137004b6e00b95
      size: 8384999
    - path: data_test/interim/train/fr/tfidf_idf.txt
      md5: 55c2d0bc9be25cbfb418e9235b82d30e
      size: 18889
    - path: data_test/interim/train/fr/tfidf_vocab.txt
      md5: 18e25d03d865c2acacd838340ac8b93c
      size: 10998
    - path: data_test/interim/train/fr/tfidf_vocab_words.txt
      md5: e7ed4eba4cd14e79b06af4714d1a6e99
      size: 7733
    - path: models//fr/model.txt
      md5: ffbb57660c42ef82bbef017486daac27
      size: 240118
    - path: models//fr/pca.pkl
      md5: da792008f3103caeb5ee7396c9bb2aa6
      size: 3163937
    - path: models//fr/tfidf.pkl
      md5: 2b3fc3ab5e2e8034054c14125abb763c
      size: 579541
    - path: reports//fr/confusion.csv
      md5: 0fb9c4888d3b72012ac0e5787ea6bfd4
      size: 697
    - path: reports//fr/confusion.pdf
      md5: c47a774e1447c6c7abc5ce8f292628a5
      size: 19676
    - path: reports//fr/metrics.json
      md5: 0913ab61f9f5a4dcdee9fb105d966590
      size: 60
    - path: reports//fr/pca_fig.pdf
      md5: 4aa81cfa2d4e3a697bf96860119a15ce
      size: 13017
  tika_es:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/raw//es
      md5: 63a3139e0c9d1d0692faa3bf7525ba40.dir
      size: 382067086
      nfiles: 2161
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//es
      md5: 6a2b0c57feea6429525e68069307090f.dir
      size: 47063687
      nfiles: 2161
  tokenizer_es:
    cmd: export PYTHONPATH=$PWD && python -m spacy download es_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=es
    deps:
    - path: data_test/interim/tika/es
      md5: 6a2b0c57feea6429525e68069307090f.dir
      size: 47063687
      nfiles: 2161
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/es
      md5: 6168b03c25bda251d700dfb3f75eb866.dir
      size: 16124191
      nfiles: 9
  train_es:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/interim/tokenizer/es
      md5: 6168b03c25bda251d700dfb3f75eb866.dir
      size: 16124191
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/es/pca.txt
      md5: 099ebc5beeaf7cc8b5967ae75b6d5cd0
      size: 8385214
    - path: data_test/interim/train/es/tfidf_idf.txt
      md5: d79b075ae295369039da6e02f66f2924
      size: 18862
    - path: data_test/interim/train/es/tfidf_vocab.txt
      md5: 45b88a4f6f8cf0033b348f60b09a2d71
      size: 11000
    - path: data_test/interim/train/es/tfidf_vocab_words.txt
      md5: 189d67057d75866b827f92e09be6d592
      size: 7845
    - path: models//es/model.txt
      md5: 0f29da84ab51c40dde71c173b1bb32b1
      size: 277891
    - path: models//es/pca.pkl
      md5: ec73dc1cc0985cad368a691594e7802b
      size: 3163931
    - path: models//es/tfidf.pkl
      md5: 47b7475bc61660cdaae7a33c1f222301
      size: 849535
    - path: reports//es/confusion.csv
      md5: b8d6592ef54299ec77bc1c851383ad97
      size: 633
    - path: reports//es/confusion.pdf
      md5: 91c73028c39c129fb17cf23ed16cbb94
      size: 19660
    - path: reports//es/metrics.json
      md5: e893cbcfb01d8a69bb0d42f58a595b6d
      size: 60
    - path: reports//es/pca_fig.pdf
      md5: b45a6db7efaa9b16e34a03fc7ffd8884
      size: 12629
  tika_it:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/raw//it
      md5: 6371c87cebe3e993317be52384d42076.dir
      size: 444942238
      nfiles: 1866
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//it
      md5: a93dc72cd5402b725b3508534051be15.dir
      size: 41664696
      nfiles: 1866
  tokenizer_it:
    cmd: export PYTHONPATH=$PWD && python -m spacy download it_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=it
    deps:
    - path: data_test/interim/tika/it
      md5: a93dc72cd5402b725b3508534051be15.dir
      size: 41664696
      nfiles: 1866
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/it
      md5: 089cdf24b6fff3febae532256f3b7950.dir
      size: 19759118
      nfiles: 9
  train_it:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/interim/tokenizer/it
      md5: 089cdf24b6fff3febae532256f3b7950.dir
      size: 19759118
      nfiles: 9
    - path: src/train_model.py
      md5: 15e8aa8da26da467c405a0fe01011897
      size: 8047
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 384
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/it/pca.txt
      md5: d5d63007730f25c842865f1c93d62265
      size: 8384914
    - path: data_test/interim/train/it/tfidf_idf.txt
      md5: 8a28f76c034d6f426d886e42dfdbe2d6
      size: 18940
    - path: data_test/interim/train/it/tfidf_vocab.txt
      md5: 1990bc7b2233af0c41e0d43e04d64e84
      size: 11014
    - path: data_test/interim/train/it/tfidf_vocab_words.txt
      md5: b15d2674456e1fb5927ccc97c879e1a6
      size: 7715
    - path: models//it/model.txt
      md5: 8e2a5dfc9d67f2ceadf2e86affd78589
      size: 136265
    - path: models//it/pca.pkl
      md5: 245500f8ce0b223a2c028dcf2c03fa83
      size: 3163937
    - path: models//it/tfidf.pkl
      md5: 8459c46f54f1f0eb4c45906b22875b73
      size: 780868
    - path: reports//it/confusion.csv
      md5: fb0444fa71f44d6b68eb0eb4502a5a59
      size: 661
    - path: reports//it/confusion.pdf
      md5: f274af79d2f2a0a98cd7adbdde4a7537
      size: 19540
    - path: reports//it/metrics.json
      md5: 14fffe498b2b14980b5c2b85900adfc3
      size: 75
    - path: reports//it/pca_fig.pdf
      md5: 351939455d34a8065bca0c6c10890330
      size: 12979
