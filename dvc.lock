schema: '2.0'
stages:
  tika_de:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=de
    deps:
    - path: data_test/raw//de
      md5: 358fa374b312736881e8be829500010d.dir
      size: 100607039
      nfiles: 205
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//de
      md5: 9857051be79a3ce405cd9da65e99dd9e.dir
      size: 6711969
      nfiles: 205
  tokenizer_de:
    cmd: export PYTHONPATH=$PWD && python -m spacy download de_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=de
    deps:
    - path: data_test/interim/tika/de
      md5: 9857051be79a3ce405cd9da65e99dd9e.dir
      size: 6711969
      nfiles: 205
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/de
      md5: f3b62d17b930d6a7b102bc1ec7c3f705.dir
      size: 3161416
      nfiles: 9
  train_de:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=de
    deps:
    - path: data_test/interim/tokenizer/de
      md5: f3b62d17b930d6a7b102bc1ec7c3f705.dir
      size: 3161416
      nfiles: 9
    - path: src/train_model.py
      md5: fe8830430b876350efcdfa5eec990310
      size: 7809
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 40
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/de/pca.txt
      md5: c33ed86b7f0d2835586d5054acf09f2b
      size: 904126
    - path: data_test/interim/train/de/tfidf_idf.txt
      md5: 19a7235c44eeb02e06625b8e9c23ac73
      size: 18904
    - path: data_test/interim/train/de/tfidf_vocab.txt
      md5: 9d60748e3e608a2962b1c4348a4739f0
      size: 10990
    - path: data_test/interim/train/de/tfidf_vocab_words.txt
      md5: 861bc989b5b12262e450d6649ea1c923
      size: 7876
    - path: models//de/model.txt
      md5: bcb8dbf8f482a4b93ab29c92e556dd85
      size: 6338
    - path: models//de/pca.pkl
      md5: 92d38603c3d8d246db150c1c86121534
      size: 337626
    - path: reports//de/confusion.csv
      md5: 6d1f03274abefdd2d6196839656d926e
      size: 101
    - path: reports//de/metrics.json
      md5: 50a4e0e314ad2fc9a37f84393e13bca1
      size: 61
  make_small_dataset:
    cmd: export PYTHONPATH=$PWD && python src/make_test_dataset.py --config=params.yaml
      --test_dir=data_test
    deps:
    - path: src/make_test_dataset.py
      md5: 369f9c4f31aa5e866b26ac0bd2784a77
      size: 1566
    outs:
    - path: data_test/raw
      md5: 61028a947c595be60db3f480f10cebcc.dir
      size: 298047834
      nfiles: 848
  tika_fr:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/raw//fr
      md5: 99309230414a0c5f9d604a18a19dba4a.dir
      size: 67934726
      nfiles: 218
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//fr
      md5: 4dee194f5756ac245333640152881c35.dir
      size: 4884861
      nfiles: 218
  tokenizer_fr:
    cmd: export PYTHONPATH=$PWD && python -m spacy download fr_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=fr
    deps:
    - path: data_test/interim/tika/fr
      md5: 4dee194f5756ac245333640152881c35.dir
      size: 4884861
      nfiles: 218
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/fr
      md5: 2eb4fd6f51ccd48253c637d620b322b4.dir
      size: 2266604
      nfiles: 9
  train_fr:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=fr
    deps:
    - path: data_test/interim/tokenizer/fr
      md5: 2eb4fd6f51ccd48253c637d620b322b4.dir
      size: 2266604
      nfiles: 9
    - path: src/train_model.py
      md5: fe8830430b876350efcdfa5eec990310
      size: 7809
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 40
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/fr/pca.txt
      md5: 2aaaed4c59fee22d4fafc4aa71a94ed8
      size: 903995
    - path: data_test/interim/train/fr/tfidf_idf.txt
      md5: f8bf8ac6bb53bcf4bfd966f03d4fc441
      size: 19004
    - path: data_test/interim/train/fr/tfidf_vocab.txt
      md5: 062d0e4fefd1fa7700f3b96d50ca1089
      size: 10999
    - path: data_test/interim/train/fr/tfidf_vocab_words.txt
      md5: 4110b01bead8f0af9434dd90d297be36
      size: 7930
    - path: models//fr/model.txt
      md5: 1d8792ad10efe5f159c9829ec8449844
      size: 6335
    - path: models//fr/pca.pkl
      md5: 5fbdc2884126934199a9a61eb0117c62
      size: 337626
    - path: reports//fr/confusion.csv
      md5: d2ba15bc6e99dfd1e05e83131b51d180
      size: 93
    - path: reports//fr/metrics.json
      md5: 54fcd19e766071b4d69ea33e61665abf
      size: 77
  tika_es:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/raw//es
      md5: 2f9b8d415aa60da4a90c87966ea366d7.dir
      size: 54698445
      nfiles: 229
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//es
      md5: 135edeb53ea5827cfc40c02767e574f5.dir
      size: 10909073
      nfiles: 229
  tokenizer_es:
    cmd: export PYTHONPATH=$PWD && python -m spacy download es_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=es
    deps:
    - path: data_test/interim/tika/es
      md5: 135edeb53ea5827cfc40c02767e574f5.dir
      size: 10909073
      nfiles: 229
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/es
      md5: ef7e192185c54b29949e86aef63a44d1.dir
      size: 1957425
      nfiles: 9
  train_es:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=es
    deps:
    - path: data_test/interim/tokenizer/es
      md5: ef7e192185c54b29949e86aef63a44d1.dir
      size: 1957425
      nfiles: 9
    - path: src/train_model.py
      md5: fe8830430b876350efcdfa5eec990310
      size: 7809
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 40
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/es/pca.txt
      md5: d527f9ccb7764d328603f5ff941b3660
      size: 901756
    - path: data_test/interim/train/es/tfidf_idf.txt
      md5: 945cf4554bcfbcf45033cab0885c6631
      size: 19027
    - path: data_test/interim/train/es/tfidf_vocab.txt
      md5: 0c502ef6416cc1ccf51aa004584734c6
      size: 10998
    - path: data_test/interim/train/es/tfidf_vocab_words.txt
      md5: 508efe426683773020e6afed22ec814e
      size: 7859
    - path: models//es/model.txt
      md5: 97d6097682a6b93d855cd9e76d8476c7
      size: 6342
    - path: models//es/pca.pkl
      md5: 0cf3753b5c1f0ca7c6bdb365f347cf63
      size: 337626
    - path: reports//es/confusion.csv
      md5: 5200d7456872f036909887391331ca9d
      size: 93
    - path: reports//es/metrics.json
      md5: af89116ce674b2470e3dc993559a1a0e
      size: 61
  tika_it:
    cmd: export PYTHONPATH=$PWD && python src/tika_parser.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/raw//it
      md5: 25f177f79d071d0d9a7528103767b838.dir
      size: 74807624
      nfiles: 196
    - path: src/tika_parser.py
      md5: 1de949225b2f26c35330fb0962d52592
      size: 2183
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tika:
          input_path: raw/
          output_path: interim/tika/
    outs:
    - path: data_test/interim/tika//it
      md5: 37dc2249c03d5d3ab1f78473b638674f.dir
      size: 4309483
      nfiles: 196
  tokenizer_it:
    cmd: export PYTHONPATH=$PWD && python -m spacy download it_core_news_sm && python
      src/tokenizer.py --config=params.yaml --locale=it
    deps:
    - path: data_test/interim/tika/it
      md5: 37dc2249c03d5d3ab1f78473b638674f.dir
      size: 4309483
      nfiles: 196
    - path: src/tokenizer.py
      md5: d21960ec0414a251f3585619c9598040
      size: 3934
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer:
          min_tokens: 500
          max_symbols: 250000
          input_path: interim/tika
          output_path: interim/tokenizer
          industries:
          - finance_banking
          - it_research_development
          - manufacturing
          - medical_medicine_paramedical
          - sales_marketing_pr
          - businises_corporate
          - hr
          - legal
          - others
    outs:
    - path: data_test/interim/tokenizer/it
      md5: 8ba4c85e6ef1856b9137e332d4a18af5.dir
      size: 2420368
      nfiles: 9
  train_it:
    cmd: export PYTHONPATH=$PWD && python src/train_model.py --config=params.yaml
      --locale=it
    deps:
    - path: data_test/interim/tokenizer/it
      md5: 8ba4c85e6ef1856b9137e332d4a18af5.dir
      size: 2420368
      nfiles: 9
    - path: src/train_model.py
      md5: fe8830430b876350efcdfa5eec990310
      size: 7809
    params:
      params.yaml:
        base:
          log_level: DEBUG
          random_seed: 42
          log_path: logs
          crawlers:
          - colly
          - google
          - common
          data_dir: data_test
        tokenizer.industries:
        - finance_banking
        - it_research_development
        - manufacturing
        - medical_medicine_paramedical
        - sales_marketing_pr
        - businises_corporate
        - hr
        - legal
        - others
        train:
          input_path: interim/tokenizer
          interim_path: interim/train
          test_size: 0.25
          max_features: 1024
          reports_path: reports/
          models_path: models/
          pca_components: 40
          lightgbm_parameters:
            learning_rate: 0.15
            boosting: gbdt
            max_depth: 2
            objective: multiclass
            num_iterations: 120
            subsample: 0.5
            subsample_freq: 1
            is_unbalance: true
            reg_lambda: 0.01
            random_state: 42
            early_stopping_round: 3
            metric:
            - multi_logloss
            verbosity: -1
    outs:
    - path: data_test/interim/train/it/pca.txt
      md5: 83da00af2136ac7880144db9185de7a5
      size: 903697
    - path: data_test/interim/train/it/tfidf_idf.txt
      md5: 83cc619cf38a5919aa2b6e094d85ba2f
      size: 18895
    - path: data_test/interim/train/it/tfidf_vocab.txt
      md5: 6d23ddd948c154a1a3bf6609e728c2a6
      size: 11027
    - path: data_test/interim/train/it/tfidf_vocab_words.txt
      md5: 21209bf68be8a09a319e14a38677c89f
      size: 7932
    - path: models//it/model.txt
      md5: 5fd2ad21a4b1ff95ad1e80dbcc74eefd
      size: 6335
    - path: models//it/pca.pkl
      md5: 6eb745501994fe76b1435ef8912bccaa
      size: 337626
    - path: reports//it/confusion.csv
      md5: 1b877543985e813ae450047aa86f5287
      size: 89
    - path: reports//it/metrics.json
      md5: 1858e59509cad8ca5896bd3280a78273
      size: 76
